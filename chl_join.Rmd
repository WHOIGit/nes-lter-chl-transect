---
title: "chl_join"
author: "Kate Morkeski"
date: "2/10/2021"
output: html_document
---

This code joins Ocean Observatories Initiative chlorophyll data with NES-LTER chlorophyll data (it will when it's done).

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```
```{r}
library(here)
library(tidyverse)
library(readxl)
here("chl_join")
```
Read in chlorophyll data file downloaded from alfresco.oceanobservatories.org under space Coastal Pioneer Array, Cruise Data, Pioneer-09_AR24_2017-10-22, Ship Data, Water Sampling. Format cruise identifier and column headers. 

```{r}
pioneer <- read_excel('Pioneer-09_AR24_Chlorophyll_Sample_Data_2020-03-27_ver_1-00.xlsx')

pioneer$Cruise <- gsub("-", "", pioneer$Cruise)

pioneer <- pioneer %>% 
  rename (cruise = Cruise, 
          cast = Cast, 
          niskin = Niskin, 
          replicate = Replicate)
```
Read in AR24B and AR24C data from API and join to AR24 data from Alfresco.

```{r}
AR24B <- read_csv("https://nes-lter-data.whoi.edu/api/chl/ar24b.csv")

AR24Ball <- full_join(pioneer, AR24B, by = c('cruise','cast','niskin','replicate'))

#view(AR24Ball)

#write.csv(AR24Ball, 'AR24Ball.csv')

AR24C <- read_csv("https://nes-lter-data.whoi.edu/api/chl/ar24c.csv")

AR24all <- full_join(AR24Ball, AR24C, by = c('cruise','cast','niskin','replicate'))

write.csv(AR24all, 'AR24all.csv')

```
Read in csv file of concatenated cruises (ie transect data)
Will need to join with AR24 data

```{r}
api_chl <- read_csv("chl-transect-api.csv")
```
